# Анализ результатов

## Параметры машины
1,2 GHz 4‑ядерный процессор Intel Core i7

## VisualVM
#### Вкладка Threads:
![Screen from visual vm threads](visual-vm-threads.png?raw=true "Screen from visual vm threads")

#### Вкладка Monitor:
![Screen from visual vm monitor](visual-vm-monitor.png?raw=true "Screen from visual vm monitor")


## PUT
### 1
Запускаю wrk c такими параметрами:
+ 4 threads (worker) send requests
+ keeping 16 HTTP connections open
+ 30 seconds
+ constant throughput of 32000 requests per second

Результаты с async profiler-а (CPU):
![Flame graph from async profiler](put-cpu-4-16-30-32000.svg?raw=true "Flame graph from async profiler")

Результаты с async profiler-а (ALLOC):
![Flame graph from async profiler](put-alloc-4-16-30-32000.svg?raw=true "Flame graph from async profiler")

Результаты с async profiler-а (LOCK):
![Flame graph from async profiler](put-lock-4-16-30-32000.svg?raw=true "Flame graph from async profiler")

Результаты wrk2:
```
Running 30s test @ http://127.0.0.1:8080
  4 threads and 16 connections
  Thread calibration: mean lat.: 2.114ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 2.049ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.990ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 2.055ms, rate sampling interval: 10ms
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     4.18ms    9.85ms  80.13ms   92.14%
    Req/Sec     8.45k     1.08k   16.20k    76.77%
  Latency Distribution (HdrHistogram - Recorded Latency)
 50.000%    1.29ms
 75.000%    1.97ms
 90.000%    7.14ms
 99.000%   54.01ms
 99.900%   68.99ms
 99.990%   78.91ms
 99.999%   80.00ms
100.000%   80.19ms
  Detailed Percentile spectrum:
       Value   Percentile   TotalCount 1/(1-Percentile)
       0.067     0.000000            2         1.00
       0.462     0.100000        64088         1.11
       0.690     0.200000       128051         1.25
       0.903     0.300000       191899         1.43
       1.101     0.400000       255816         1.67
       1.292     0.500000       319816         2.00
       1.394     0.550000       351939         2.22
       1.503     0.600000       383697         2.50
       1.628     0.650000       415739         2.86
       1.776     0.700000       447672         3.33
       1.965     0.750000       479603         4.00
       2.087     0.775000       495708         4.44
       2.239     0.800000       511489         5.00
       2.461     0.825000       527562         5.71
       2.891     0.850000       543457         6.67
       4.207     0.875000       559440         8.00
       5.339     0.887500       567430         8.89
       7.135     0.900000       575410        10.00
      10.255     0.912500       583405        11.43
      15.799     0.925000       591396        13.33
      21.855     0.937500       599389        16.00
      24.991     0.943750       603396        17.78
      27.679     0.950000       607381        20.00
      30.719     0.956250       611376        22.86
      33.471     0.962500       615384        26.67
      36.383     0.968750       619396        32.00
      37.919     0.971875       621375        35.56
      39.647     0.975000       623398        40.00
      41.375     0.978125       625393        45.71
      43.359     0.981250       627372        53.33
      46.079     0.984375       629375        64.00
      47.807     0.985938       630365        71.11
      50.047     0.987500       631360        80.00
      52.575     0.989062       632352        91.43
      54.975     0.990625       633362       106.67
      56.575     0.992188       634366       128.00
      57.567     0.992969       634848       142.22
      58.399     0.993750       635364       160.00
      59.071     0.994531       635848       182.86
      59.903     0.995313       636360       213.33
      60.639     0.996094       636858       256.00
      60.991     0.996484       637107       284.44
      61.631     0.996875       637353       320.00
      62.559     0.997266       637600       365.71
      63.967     0.997656       637853       426.67
      65.023     0.998047       638096       512.00
      65.599     0.998242       638234       568.89
      66.239     0.998437       638345       640.00
      67.327     0.998633       638474       731.43
      68.351     0.998828       638603       853.33
      69.183     0.999023       638728      1024.00
      69.503     0.999121       638787      1137.78
      69.887     0.999219       638851      1280.00
      71.039     0.999316       638907      1462.86
      72.511     0.999414       638970      1706.67
      73.919     0.999512       639033      2048.00
      74.431     0.999561       639062      2275.56
      75.199     0.999609       639093      2560.00
      76.095     0.999658       639124      2925.71
      76.479     0.999707       639159      3413.33
      77.119     0.999756       639186      4096.00
      77.631     0.999780       639202      4551.11
      77.887     0.999805       639221      5120.00
      78.143     0.999829       639237      5851.43
      78.463     0.999854       639253      6826.67
      78.719     0.999878       639266      8192.00
      78.847     0.999890       639275      9102.22
      78.975     0.999902       639291     10240.00
      78.975     0.999915       639291     11702.86
      79.103     0.999927       639299     13653.33
      79.231     0.999939       639310     16384.00
      79.231     0.999945       639310     18204.44
      79.295     0.999951       639312     20480.00
      79.423     0.999957       639317     23405.71
      79.487     0.999963       639320     27306.67
      79.551     0.999969       639324     32768.00
      79.615     0.999973       639325     36408.89
      79.743     0.999976       639327     40960.00
      79.807     0.999979       639330     46811.43
      79.871     0.999982       639333     54613.33
      79.871     0.999985       639333     65536.00
      79.935     0.999986       639335     72817.78
      79.935     0.999988       639335     81920.00
      79.999     0.999989       639336     93622.86
      80.063     0.999991       639337    109226.67
      80.127     0.999992       639340    131072.00
      80.127     0.999993       639340    145635.56
      80.127     0.999994       639340    163840.00
      80.127     0.999995       639340    187245.71
      80.127     0.999995       639340    218453.33
      80.127     0.999996       639340    262144.00
      80.127     0.999997       639340    291271.11
      80.191     0.999997       639342    327680.00
      80.191     1.000000       639342          inf
#[Mean    =        4.177, StdDeviation   =        9.855]
#[Max     =       80.128, Total count    =       639342]
#[Buckets =           27, SubBuckets     =         2048]
----------------------------------------------------------
  959704 requests in 30.00s, 61.32MB read
Requests/sec:  31991.33
Transfer/sec:      2.04MB
```

Итоги:
* обработали всего 959704 запросов
* прочитали 61.32MB данных 
* за 0.067 миллисекунд обработали 1ый запрос
* за 80.191  миллисекунд обработали 639342 запросов
* сервер обрабатывал 31991.33 запросов в секунду 


## GET
### 1
Запускаю wrk c такими параметрами:
+ 4 threads (worker) send requests
+ keeping 16 HTTP connections open
+ 30 seconds
+ constant throughput of 32000 requests per second

Результаты с async profiler-а (CPU):
![Flame graph from async profiler](get-cpu-4-16-30-32000.svg?raw=true "Flame graph from async profiler")

Результаты с async profiler-а (ALLOC):
![Flame graph from async profiler](get-alloc-4-16-30-32000.svg?raw=true "Flame graph from async profiler")

Результаты с async profiler-а (LOCK):
![Flame graph from async profiler](get-lock-4-16-30-32000.svg?raw=true "Flame graph from async profiler")

Результаты wrk2:
```
Running 30s test @ http://127.0.0.1:8080
  4 threads and 16 connections
  Thread calibration: mean lat.: 1.241ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.229ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.238ms, rate sampling interval: 10ms
  Thread calibration: mean lat.: 1.245ms, rate sampling interval: 10ms
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     1.50ms    2.33ms  38.46ms   97.88%
    Req/Sec     8.46k     1.03k   17.22k    80.24%
  Latency Distribution (HdrHistogram - Recorded Latency)
 50.000%    1.22ms
 75.000%    1.70ms
 90.000%    2.17ms
 99.000%   10.43ms
 99.900%   33.06ms
 99.990%   37.06ms
 99.999%   38.17ms
100.000%   38.49ms
  Detailed Percentile spectrum:
       Value   Percentile   TotalCount 1/(1-Percentile)
       0.033     0.000000            1         1.00
       0.415     0.100000        64144         1.11
       0.663     0.200000       128002         1.25
       0.879     0.300000       192127         1.43
       1.058     0.400000       255806         1.67
       1.220     0.500000       319785         2.00
       1.301     0.550000       351640         2.22
       1.387     0.600000       383917         2.50
       1.480     0.650000       415746         2.86
       1.583     0.700000       447642         3.33
       1.698     0.750000       479486         4.00
       1.763     0.775000       495653         4.44
       1.832     0.800000       511644         5.00
       1.905     0.825000       527485         5.71
       1.985     0.850000       543405         6.67
       2.073     0.875000       559628         8.00
       2.121     0.887500       567412         8.89
       2.175     0.900000       575602        10.00
       2.231     0.912500       583502        11.43
       2.297     0.925000       591549        13.33
       2.375     0.937500       599414        16.00
       2.421     0.943750       603392        17.78
       2.475     0.950000       607335        20.00
       2.543     0.956250       611364        22.86
       2.629     0.962500       615345        26.67
       2.763     0.968750       619314        32.00
       2.879     0.971875       621308        35.56
       3.093     0.975000       623304        40.00
       3.649     0.978125       625297        45.71
       4.703     0.981250       627294        53.33
       6.067     0.984375       629292        64.00
       6.787     0.985938       630292        71.11
       7.775     0.987500       631295        80.00
       9.255     0.989062       632288        91.43
      11.375     0.990625       633289       106.67
      13.647     0.992188       634286       128.00
      15.023     0.992969       634787       142.22
      16.783     0.993750       635288       160.00
      19.119     0.994531       635785       182.86
      21.823     0.995313       636287       213.33
      24.591     0.996094       636785       256.00
      25.823     0.996484       637033       284.44
      27.023     0.996875       637285       320.00
      28.079     0.997266       637532       365.71
      28.927     0.997656       637782       426.67
      29.855     0.998047       638032       512.00
      30.383     0.998242       638159       568.89
      30.991     0.998437       638284       640.00
      31.695     0.998633       638406       731.43
      32.479     0.998828       638532       853.33
      33.087     0.999023       638657      1024.00
      33.407     0.999121       638725      1137.78
      33.695     0.999219       638781      1280.00
      34.047     0.999316       638844      1462.86
      34.559     0.999414       638908      1706.67
      35.007     0.999512       638971      2048.00
      35.231     0.999561       639005      2275.56
      35.455     0.999609       639034      2560.00
      35.679     0.999658       639063      2925.71
      35.967     0.999707       639095      3413.33
      36.191     0.999756       639126      4096.00
      36.319     0.999780       639140      4551.11
      36.447     0.999805       639157      5120.00
      36.575     0.999829       639173      5851.43
      36.735     0.999854       639189      6826.67
      36.863     0.999878       639204      8192.00
      36.991     0.999890       639215      9102.22
      37.055     0.999902       639218     10240.00
      37.151     0.999915       639226     11702.86
      37.343     0.999927       639235     13653.33
      37.407     0.999939       639242     16384.00
      37.471     0.999945       639247     18204.44
      37.535     0.999951       639249     20480.00
      37.599     0.999957       639253     23405.71
      37.663     0.999963       639258     27306.67
      37.759     0.999969       639261     32768.00
      37.791     0.999973       639263     36408.89
      37.919     0.999976       639267     40960.00
      37.919     0.999979       639267     46811.43
      38.015     0.999982       639269     54613.33
      38.047     0.999985       639272     65536.00
      38.047     0.999986       639272     72817.78
      38.079     0.999988       639273     81920.00
      38.175     0.999989       639275     93622.86
      38.175     0.999991       639275    109226.67
      38.207     0.999992       639276    131072.00
      38.207     0.999993       639276    145635.56
      38.303     0.999994       639278    163840.00
      38.303     0.999995       639278    187245.71
      38.303     0.999995       639278    218453.33
      38.303     0.999996       639278    262144.00
      38.303     0.999997       639278    291271.11
      38.367     0.999997       639279    327680.00
      38.367     0.999997       639279    374491.43
      38.367     0.999998       639279    436906.67
      38.367     0.999998       639279    524288.00
      38.367     0.999998       639279    582542.22
      38.495     0.999998       639280    655360.00
      38.495     1.000000       639280          inf
#[Mean    =        1.500, StdDeviation   =        2.332]
#[Max     =       38.464, Total count    =       639280]
#[Buckets =           27, SubBuckets     =         2048]
----------------------------------------------------------
  959642 requests in 30.00s, 61.81MB read
Requests/sec:  31989.78
Transfer/sec:      2.06MB
```

Итоги:
* обработали всего 959642 запросов
* прочитали 61.81MB данных 
* за 0.033  миллисекунд обработали 1ый запрос
* за 38.495 миллисекунд  обработали 639280 запросов
* сервер обрабатывал 31989.78 запросов в секунду 
