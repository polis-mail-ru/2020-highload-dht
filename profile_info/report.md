# PUT
## wrk

Старая реализация

```
./wrk  -c64 -d5m -R2000 -s put.lua --latency http://127.0.0.1:8081
Running 5m test @ http://127.0.0.1:8081
  2 threads and 64 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency    22.33ms  256.39ms   5.30s    99.17%
    Req/Sec     1.05k   360.64    20.50k    98.08%
  Latency Distribution (HdrHistogram - Recorded Latency)
 50.000%    1.64ms
 75.000%    2.02ms
 90.000%    2.56ms
 99.000%   11.31ms
 99.900%    4.24s 
 99.990%    5.04s 
 99.999%    5.21s 
100.000%    5.30s 

  Detailed Percentile spectrum:
       Value   Percentile   TotalCount 1/(1-Percentile)

       0.078     0.000000            1         1.00
       1.049     0.100000        58123         1.11
       1.228     0.200000       116034         1.25
       1.390     0.300000       174219         1.43
       1.521     0.400000       232329         1.67
       1.644     0.500000       289847         2.00
       1.708     0.550000       318988         2.22
       1.777     0.600000       348136         2.50
       1.846     0.650000       376830         2.86
       1.923     0.700000       405790         3.33
       2.020     0.750000       434868         4.00
       2.081     0.775000       449425         4.44
       2.159     0.800000       464002         5.00
       2.253     0.825000       478403         5.71
       2.353     0.850000       492794         6.67
       2.455     0.875000       507247         8.00
       2.505     0.887500       514623         8.89
       2.555     0.900000       521829        10.00
       2.607     0.912500       529170        11.43
       2.659     0.925000       536429        13.33
       2.715     0.937500       543633        16.00
       2.743     0.943750       547084        17.78
       2.775     0.950000       550834        20.00
       2.809     0.956250       554460        22.86
       2.847     0.962500       558045        26.67
       2.889     0.968750       561606        32.00
       2.913     0.971875       563384        35.56
       2.943     0.975000       565273        40.00
       2.975     0.978125       567028        45.71
       3.021     0.981250       568836        53.33
       3.101     0.984375       570635        64.00
       3.223     0.985938       571526        71.11
       5.099     0.987500       572431        80.00
       8.839     0.989062       573338        91.43
      13.607     0.990625       574242       106.67
     509.695     0.992188       575148       128.00
     873.471     0.992969       575601       142.22
    1278.975     0.993750       576054       160.00
    1674.239     0.994531       576506       182.86
    2064.383     0.995313       576959       213.33
    2559.999     0.996094       577414       256.00
    2807.807     0.996484       577643       284.44
    3039.231     0.996875       577865       320.00
    3309.567     0.997266       578091       365.71
    3510.271     0.997656       578318       426.67
    3678.207     0.998047       578548       512.00
    3753.983     0.998242       578660       568.89
    3839.999     0.998437       578775       640.00
    3940.351     0.998633       578885       731.43
    4093.951     0.998828       578997       853.33
    4259.839     0.999023       579110      1024.00
    4345.855     0.999121       579169      1137.78
    4423.679     0.999219       579225      1280.00
    4501.503     0.999316       579280      1462.86
    4595.711     0.999414       579340      1706.67
    4669.439     0.999512       579393      2048.00
    4726.783     0.999561       579425      2275.56
    4763.647     0.999609       579453      2560.00
    4804.607     0.999658       579480      2925.71
    4853.759     0.999707       579508      3413.33
    4894.719     0.999756       579537      4096.00
    4919.295     0.999780       579551      4551.11
    4947.967     0.999805       579567      5120.00
    4960.255     0.999829       579577      5851.43
    4988.927     0.999854       579594      6826.67
    5017.599     0.999878       579607      8192.00
    5042.175     0.999890       579618      9102.22
    5046.271     0.999902       579621     10240.00
    5054.463     0.999915       579628     11702.86
    5079.039     0.999927       579637     13653.33
    5083.135     0.999939       579642     16384.00
    5103.615     0.999945       579645     18204.44
    5107.711     0.999951       579648     20480.00
    5115.903     0.999957       579654     23405.71
    5136.383     0.999963       579655     27306.67
    5148.671     0.999969       579662     32768.00
    5148.671     0.999973       579662     36408.89
    5148.671     0.999976       579662     40960.00
    5173.247     0.999979       579666     46811.43
    5173.247     0.999982       579666     54613.33
    5177.343     0.999985       579668     65536.00
    5181.439     0.999986       579669     72817.78
    5181.439     0.999988       579669     81920.00
    5210.111     0.999989       579671     93622.86
    5210.111     0.999991       579671    109226.67
    5242.879     0.999992       579673    131072.00
    5242.879     0.999993       579673    145635.56
    5242.879     0.999994       579673    163840.00
    5242.879     0.999995       579673    187245.71
    5271.551     0.999995       579675    218453.33
    5271.551     0.999996       579675    262144.00
    5271.551     0.999997       579675    291271.11
    5271.551     0.999997       579675    327680.00
    5271.551     0.999997       579675    374491.43
    5271.551     0.999998       579675    436906.67
    5271.551     0.999998       579675    524288.00
    5304.319     0.999998       579676    582542.22
    5304.319     1.000000       579676          inf
[Mean    =       22.334, StdDeviation   =      256.393]
[Max     =     5300.224, Total count    =       579676]
[Buckets =           27, SubBuckets     =         2048]

  599873 requests in 5.00m, 38.41MB read

Requests/sec:   1999.58
Transfer/sec:    131.11KB


```

Асинхронная реализация

```
./wrk  -c64 -d5m -R2000 -s put.lua --latency http://127.0.0.1:8081
Running 5m test @ http://127.0.0.1:8081
  2 threads and 64 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency    44.41ms  345.93ms   4.53s    98.10%
    Req/Sec     1.06k   405.41    13.78k    96.68%
  Latency Distribution (HdrHistogram - Recorded Latency)
 50.000%    1.67ms
 75.000%    2.10ms
 90.000%    2.69ms
 99.000%    1.99s 
 99.900%    4.19s 
 99.990%    4.44s 
 99.999%    4.51s 
100.000%    4.53s 

  Detailed Percentile spectrum:
       Value   Percentile   TotalCount 1/(1-Percentile)

       0.158     0.000000            1         1.00
       1.043     0.100000        58114         1.11
       1.212     0.200000       116011         1.25
       1.357     0.300000       174226         1.43
       1.512     0.400000       231986         1.67
       1.668     0.500000       289998         2.00
       1.743     0.550000       318823         2.22
       1.820     0.600000       348147         2.50
       1.901     0.650000       377082         2.86
       1.991     0.700000       405799         3.33
       2.101     0.750000       435056         4.00
       2.163     0.775000       449526         4.44
       2.235     0.800000       463976         5.00
       2.319     0.825000       478468         5.71
       2.423     0.850000       492926         6.67
       2.549     0.875000       507425         8.00
       2.619     0.887500       514506         8.89
       2.693     0.900000       521822        10.00
       2.771     0.912500       529113        11.43
       2.855     0.925000       536214        13.33
       2.957     0.937500       543464        16.00
       3.023     0.943750       547149        17.78
       3.103     0.950000       550778        20.00
       3.231     0.956250       554342        22.86
       3.553     0.962500       557942        26.67
       4.815     0.968750       561571        32.00
       6.479     0.971875       563376        35.56
       9.615     0.975000       565188        40.00
      20.047     0.978125       566998        45.71
     429.823     0.981250       568810        53.33
     851.967     0.984375       570624        64.00
    1107.967     0.985938       571527        71.11
    1483.775     0.987500       572434        80.00
    1763.327     0.989062       573339        91.43
    2140.159     0.990625       574245       106.67
    2535.423     0.992188       575150       128.00
    2734.079     0.992969       575603       142.22
    2926.591     0.993750       576056       160.00
    3090.431     0.994531       576512       182.86
    3287.039     0.995313       576965       213.33
    3485.695     0.996094       577419       256.00
    3581.951     0.996484       577642       284.44
    3682.303     0.996875       577867       320.00
    3780.607     0.997266       578093       365.71
    3876.863     0.997656       578321       426.67
    3971.071     0.998047       578546       512.00
    4016.127     0.998242       578661       568.89
    4061.183     0.998437       578779       640.00
    4106.239     0.998633       578889       731.43
    4153.343     0.998828       579006       853.33
    4198.399     0.999023       579113      1024.00
    4227.071     0.999121       579175      1137.78
    4251.647     0.999219       579232      1280.00
    4276.223     0.999316       579283      1462.86
    4304.895     0.999414       579347      1706.67
    4329.471     0.999512       579400      2048.00
    4341.759     0.999561       579430      2275.56
    4354.047     0.999609       579455      2560.00
    4366.335     0.999658       579484      2925.71
    4382.719     0.999707       579515      3413.33
    4395.007     0.999756       579543      4096.00
    4403.199     0.999780       579555      4551.11
    4411.391     0.999805       579570      5120.00
    4419.583     0.999829       579586      5851.43
    4427.775     0.999854       579596      6826.67
    4435.967     0.999878       579608      8192.00
    4440.063     0.999890       579617      9102.22
    4448.255     0.999902       579627     10240.00
    4452.351     0.999915       579630     11702.86
    4460.543     0.999927       579639     13653.33
    4464.639     0.999939       579643     16384.00
    4468.735     0.999945       579649     18204.44
    4472.831     0.999951       579652     20480.00
    4476.927     0.999957       579654     23405.71
    4485.119     0.999963       579658     27306.67
    4489.215     0.999969       579661     32768.00
    4493.311     0.999973       579664     36408.89
    4493.311     0.999976       579664     40960.00
    4497.407     0.999979       579668     46811.43
    4497.407     0.999982       579668     54613.33
    4505.599     0.999985       579672     65536.00
    4505.599     0.999986       579672     72817.78
    4505.599     0.999988       579672     81920.00
    4505.599     0.999989       579672     93622.86
    4509.695     0.999991       579674    109226.67
    4509.695     0.999992       579674    131072.00
    4517.887     0.999993       579676    145635.56
    4517.887     0.999994       579676    163840.00
    4517.887     0.999995       579676    187245.71
    4517.887     0.999995       579676    218453.33
    4517.887     0.999996       579676    262144.00
    4521.983     0.999997       579677    291271.11
    4521.983     0.999997       579677    327680.00
    4521.983     0.999997       579677    374491.43
    4521.983     0.999998       579677    436906.67
    4521.983     0.999998       579677    524288.00
    4534.271     0.999998       579678    582542.22
    4534.271     1.000000       579678          inf
[Mean    =       44.413, StdDeviation   =      345.932]
[Max     =     4530.176, Total count    =       579678]
[Buckets =           27, SubBuckets     =         2048]

  599876 requests in 5.00m, 38.36MB read
Requests/sec:   1999.58
Transfer/sec:    130.93KB

```

Средние показатели близки друг к другу, возможно это связано, с накладными расхадами, связанными с дополнительными перемещениями данных между потоками и конвертацией, в новой реализации.
Но на 99 % новая реализация в 10 раз обгоняет старую, возможно в этот момент очередь и переполнилась и старая реализация замедлилиась.
На > 99,9% разница уменьшается, но новая реализация все равно быстрее.

## CPU
Старая реализация
![image](https://github.com/re1nex/2020-highload-dht/blob/hw6/profile_info/old%20ver/put/cpu.svg)

Асинхронная реализация
![image](https://github.com/re1nex/2020-highload-dht/blob/hw6/profile_info/async/put/cpu.svg)

Количество сэмплов селекторов one.nio уменьшилось до 8%, т.к. теперь еще добавились селекторы HttpClient (10%) . 12% ушло на ForkJoinWorkerThread, внутри которого выполнялся upsert в dao(4%). На пул экзекьютерова распределено приблизительно столько же сэмплов, сколько и в старой версии, но внутри теперь идет распределение на ComplatableFuture (10%). getTask(20%) , 20% на сетевое взаимодействие нового клиента и всего 10% на разборы запросов ( родительский запрос или локальный, нахождение реплик и т.д.), что существенно отличается от предыдущего этапа.

## ALLOC
Старая реализация
![image](https://github.com/re1nex/2020-highload-dht/blob/hw6/profile_info/old%20ver/put/alloc.svg)

Асинхронная реализация
![image](https://github.com/re1nex/2020-highload-dht/blob/hw6/profile_info/async/put/alloc.svg)

По аллокациям на селекторы уходит приблизительно столько же, но еще 2% уходит на менеджер селекторов нового клиента, появились новый расходы на ForkJoinWorkerThread (14%), на ComplatableFuture(7%), на сам сервис всего 25%, что более чем в 2 раза меньше, чем в предыдущем этапе.

## LOCK 
Старая реализация
![image](https://github.com/re1nex/2020-highload-dht/blob/hw6/profile_info/old%20ver/put/lock.svg)

Асинхронная реализация
![image](https://github.com/re1nex/2020-highload-dht/blob/hw6/profile_info/async/put/lock.svg)


Тут тоже достаточно координально все поменялось , количество локов селекторов one.nio сократилось до 1%, SelectorManager нового клиента занял 31%, getTask теперь занимает всего 8% , основные расходы на CompatableFuture (29%) и на новый клиент (30%).

# Get
## wrk

Старая реализация
```
./wrk  -c64 -d5m -R2000 -s get.lua --latency http://127.0.0.1:8081
Running 5m test @ http://127.0.0.1:8081
  2 threads and 64 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     2.44ms    2.50ms  93.25ms   98.78%
    Req/Sec     1.05k   108.08     2.33k    74.87%
  Latency Distribution (HdrHistogram - Recorded Latency)
 50.000%    2.22ms
 75.000%    2.65ms
 90.000%    3.03ms
 99.000%   12.01ms
 99.900%   39.94ms
 99.990%   64.00ms
 99.999%   83.58ms
100.000%   93.31ms

  Detailed Percentile spectrum:
       Value   Percentile   TotalCount 1/(1-Percentile)

       0.112     0.000000            1         1.00
       1.472     0.100000        58043         1.11
       1.751     0.200000       116203         1.25
       1.924     0.300000       173923         1.43
       2.075     0.400000       232019         1.67
       2.223     0.500000       289896         2.00
       2.301     0.550000       319157         2.22
       2.381     0.600000       348374         2.50
       2.465     0.650000       377137         2.86
       2.555     0.700000       406283         3.33
       2.649     0.750000       434942         4.00
       2.701     0.775000       449773         4.44
       2.755     0.800000       464025         5.00
       2.813     0.825000       478374         5.71
       2.877     0.850000       492818         6.67
       2.949     0.875000       507428         8.00
       2.989     0.887500       514592         8.89
       3.033     0.900000       521874        10.00
       3.081     0.912500       529181        11.43
       3.135     0.925000       536336        13.33
       3.197     0.937500       543528        16.00
       3.233     0.943750       547183        17.78
       3.271     0.950000       550713        20.00
       3.317     0.956250       554338        22.86
       3.371     0.962500       557974        26.67
       3.435     0.968750       561568        32.00
       3.477     0.971875       563416        35.56
       3.525     0.975000       565189        40.00
       3.585     0.978125       567046        45.71
       3.665     0.981250       568812        53.33
       3.805     0.984375       570628        64.00
       3.973     0.985938       571531        71.11
       4.687     0.987500       572435        80.00
       6.075     0.989062       573339        91.43
       8.815     0.990625       574244       106.67
      12.271     0.992188       575152       128.00
      14.431     0.992969       575603       142.22
      16.671     0.993750       576056       160.00
      18.671     0.994531       576508       182.86
      20.751     0.995313       576963       213.33
      23.119     0.996094       577415       256.00
      24.559     0.996484       577644       284.44
      26.095     0.996875       577867       320.00
      27.871     0.997266       578095       365.71
      29.903     0.997656       578321       426.67
      32.191     0.998047       578546       512.00
      33.471     0.998242       578661       568.89
      34.847     0.998437       578774       640.00
      36.575     0.998633       578889       731.43
      38.271     0.998828       578999       853.33
      40.255     0.999023       579112      1024.00
      41.343     0.999121       579169      1137.78
      42.783     0.999219       579226      1280.00
      44.255     0.999316       579282      1462.86
      46.527     0.999414       579340      1706.67
      48.575     0.999512       579395      2048.00
      50.175     0.999561       579425      2275.56
      51.487     0.999609       579452      2560.00
      53.119     0.999658       579480      2925.71
      54.783     0.999707       579509      3413.33
      56.351     0.999756       579537      4096.00
      57.311     0.999780       579551      4551.11
      58.047     0.999805       579565      5120.00
      59.839     0.999829       579579      5851.43
      61.919     0.999854       579595      6826.67
      62.783     0.999878       579608      8192.00
      63.455     0.999890       579615      9102.22
      64.255     0.999902       579622     10240.00
      65.855     0.999915       579629     11702.86
      67.967     0.999927       579636     13653.33
      70.655     0.999939       579643     16384.00
      72.191     0.999945       579647     18204.44
      72.511     0.999951       579650     20480.00
      73.215     0.999957       579654     23405.71
      74.111     0.999963       579658     27306.67
      76.287     0.999969       579662     32768.00
      77.375     0.999973       579663     36408.89
      78.783     0.999976       579664     40960.00
      80.703     0.999979       579666     46811.43
      82.047     0.999982       579668     54613.33
      82.751     0.999985       579670     65536.00
      83.519     0.999986       579671     72817.78
      83.519     0.999988       579671     81920.00
      83.583     0.999989       579672     93622.86
      84.351     0.999991       579673    109226.67
      85.759     0.999992       579674    131072.00
      85.823     0.999993       579675    145635.56
      85.823     0.999994       579675    163840.00
      85.823     0.999995       579675    187245.71
      87.423     0.999995       579676    218453.33
      87.423     0.999996       579676    262144.00
      91.007     0.999997       579677    291271.11
      91.007     0.999997       579677    327680.00
      91.007     0.999997       579677    374491.43
      91.007     0.999998       579677    436906.67
      91.007     0.999998       579677    524288.00
      93.311     0.999998       579678    582542.22
      93.311     1.000000       579678          inf
[Mean    =        2.439, StdDeviation   =        2.496]
[Max     =       93.248, Total count    =       579678]
[Buckets =           27, SubBuckets     =         2048]

  599872 requests in 5.00m, 42.09MB read
 
Requests/sec:   1999.57
Transfer/sec:    143.66KB

```

Асинхронная реализация
```
./wrk  -c64 -d5m -R2000 -s get.lua --latency http://127.0.0.1:8081
Running 5m test @ http://127.0.0.1:8081
  2 threads and 64 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     2.30ms    2.26ms  81.79ms   95.97%
    Req/Sec   774.83    220.07     2.56k    65.32%
  Latency Distribution (HdrHistogram - Recorded Latency)
 50.000%    1.99ms
 75.000%    2.46ms
 90.000%    3.02ms
 99.000%    7.58ms
 99.900%   30.94ms
 99.990%   49.92ms
 99.999%   68.35ms
100.000%   81.86ms

  Detailed Percentile spectrum:
       Value   Percentile   TotalCount 1/(1-Percentile)

       0.191     0.000000            1         1.00
       1.107     0.100000        42584         1.11
       1.437     0.200000        85269         1.25
       1.641     0.300000       127905         1.43
       1.821     0.400000       170508         1.67
       1.993     0.500000       212921         2.00
       2.079     0.550000       234223         2.22
       2.169     0.600000       255904         2.50
       2.257     0.650000       276892         2.86
       2.351     0.700000       298154         3.33
       2.457     0.750000       319586         4.00
       2.517     0.775000       330133         4.44
       2.583     0.800000       340860         5.00
       2.661     0.825000       351482         5.71
       2.755     0.850000       362014         6.67
       2.871     0.875000       372586         8.00
       2.939     0.887500       377895         8.89
       3.019     0.900000       383222        10.00
       3.117     0.912500       388531        11.43
       3.245     0.925000       393902        13.33
       3.439     0.937500       399204        16.00
       3.597     0.943750       401865        17.78
       3.851     0.950000       404498        20.00
       4.259     0.956250       407174        22.86
       4.851     0.962500       409821        26.67
       5.671     0.968750       412486        32.00
       6.155     0.971875       413814        35.56
       6.715     0.975000       415147        40.00
       7.387     0.978125       416481        45.71
       8.199     0.981250       417801        53.33
       9.231     0.984375       419138        64.00
       9.855     0.985938       419800        71.11
      10.623     0.987500       420469        80.00
      11.415     0.989062       421129        91.43
      12.415     0.990625       421797       106.67
      13.567     0.992188       422459       128.00
      14.327     0.992969       422791       142.22
      15.175     0.993750       423124       160.00
      16.183     0.994531       423457       182.86
      17.343     0.995313       423790       213.33
      18.719     0.996094       424122       256.00
      19.663     0.996484       424288       284.44
      20.751     0.996875       424454       320.00
      21.967     0.997266       424622       365.71
      23.455     0.997656       424787       426.67
      25.023     0.998047       424953       512.00
      25.903     0.998242       425036       568.89
      27.007     0.998437       425119       640.00
      28.287     0.998633       425202       731.43
      29.551     0.998828       425287       853.33
      31.119     0.999023       425372      1024.00
      31.919     0.999121       425410      1137.78
      33.055     0.999219       425452      1280.00
      34.015     0.999316       425493      1462.86
      35.359     0.999414       425536      1706.67
      36.831     0.999512       425577      2048.00
      37.407     0.999561       425598      2275.56
      38.399     0.999609       425619      2560.00
      39.551     0.999658       425639      2925.71
      40.831     0.999707       425660      3413.33
      41.823     0.999756       425681      4096.00
      43.071     0.999780       425691      4551.11
      44.031     0.999805       425701      5120.00
      45.471     0.999829       425712      5851.43
      46.207     0.999854       425722      6826.67
      48.319     0.999878       425733      8192.00
      49.631     0.999890       425739      9102.22
      50.527     0.999902       425743     10240.00
      50.911     0.999915       425749     11702.86
      51.903     0.999927       425753     13653.33
      53.759     0.999939       425759     16384.00
      54.495     0.999945       425761     18204.44
      56.927     0.999951       425764     20480.00
      57.247     0.999957       425766     23405.71
      58.399     0.999963       425769     27306.67
      60.927     0.999969       425772     32768.00
      62.271     0.999973       425773     36408.89
      62.591     0.999976       425774     40960.00
      64.223     0.999979       425775     46811.43
      64.383     0.999982       425777     54613.33
      64.447     0.999985       425778     65536.00
      64.543     0.999986       425779     72817.78
      64.543     0.999988       425779     81920.00
      68.351     0.999989       425780     93622.86
      68.479     0.999991       425781    109226.67
      68.479     0.999992       425781    131072.00
      71.871     0.999993       425782    145635.56
      71.871     0.999994       425782    163840.00
      71.871     0.999995       425782    187245.71
      75.455     0.999995       425783    218453.33
      75.455     0.999996       425783    262144.00
      75.455     0.999997       425783    291271.11
      75.455     0.999997       425783    327680.00
      75.455     0.999997       425783    374491.43
      81.855     0.999998       425784    436906.67
      81.855     1.000000       425784          inf
#[Mean    =        2.303, StdDeviation   =        2.262]
#[Max     =       81.792, Total count    =       425784]
#[Buckets =           27, SubBuckets     =         2048]

  445981 requests in 5.00m, 31.25MB read

Requests/sec:   1486.58
Transfer/sec:    106.68KB

```
В среднем новая реализация обгоняет старую в 1,3 раза.
на 99% разница увеличивается до 1,6 
на 99,9% разница уменьшается до 1,3%

## CPU
Старая реализация
![image](https://github.com/re1nex/2020-highload-dht/blob/hw6/profile_info/old%20ver/get/cpu.svg)

Асинхронная реализация
![image](https://github.com/re1nex/2020-highload-dht/blob/hw6/profile_info/async/get/cpu.svg)

Распределение сэмплов на селектор one.nio и менеджер селекторов java.net приблизительно совпадает с тем, сколько раньше было распеделено на селекторы. Появились новые сэмплы  ForkJoinWorker (2%) . На сам метод get количество уменьшилось на 10% . Количество сэмплов сервиса (распределение запросов, поиск нод в топологии и т.д.) уменьшилось в несколько раз.

## ALLOC
Старая реализация
![image](https://github.com/re1nex/2020-highload-dht/blob/hw6/profile_info/old%20ver/get/alloc.svg)

Асинхронная реализация
![image](https://github.com/re1nex/2020-highload-dht/blob/hw6/profile_info/async/get/alloc.svg)

На селекторы расход такой же, что ожидаемо, т.к. количество запросов не увеличилось. На сам запрос к dao тоже расход такой же. Добавились новые расходы на ComplatableFuture (8%) , распределение сэмплов на сервис также уменьшилось в несколько раз.

## LOCK 
Старая реализация
![image](https://github.com/re1nex/2020-highload-dht/blob/hw6/profile_info/old%20ver/get/lock.svg)

Асинхронная реализация
![image](https://github.com/re1nex/2020-highload-dht/blob/hw6/profile_info/async/get/lock.svg)

Появились локи java.net SelectorManager(12%). Количество локов связанных c get из dao почти не изменилось. Появились дополнительные локи связанные с фьючами (11%) и новым клиентом (12%).
